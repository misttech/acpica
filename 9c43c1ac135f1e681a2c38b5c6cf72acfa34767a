{
  "comments": [
    {
      "key": {
        "uuid": "562ce734_bca9f512",
        "filename": "BUILD.gn",
        "patchSetId": 1
      },
      "lineNbr": 29,
      "author": {
        "id": 5155
      },
      "writtenOn": "2020-02-25T19:06:53Z",
      "side": 1,
      "message": "typo",
      "range": {
        "startLine": 29,
        "startChar": 30,
        "endLine": 29,
        "endChar": 38
      },
      "revId": "9c43c1ac135f1e681a2c38b5c6cf72acfa34767a",
      "serverId": "ccdefb6c-23ea-33ff-848c-339fc6ca2269",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ca2f6919_187571e0",
        "filename": "source/components/hardware/hwsleep.c",
        "patchSetId": 1
      },
      "lineNbr": 109,
      "author": {
        "id": 5232
      },
      "writtenOn": "2020-02-25T19:12:00Z",
      "side": 1,
      "message": "Could you add a short comment on why Fuichsia can\u0027t use the existing power method you\u0027ve split out into AcpiHwLegacySleepFinal?",
      "range": {
        "startLine": 109,
        "startChar": 0,
        "endLine": 109,
        "endChar": 45
      },
      "revId": "9c43c1ac135f1e681a2c38b5c6cf72acfa34767a",
      "serverId": "ccdefb6c-23ea-33ff-848c-339fc6ca2269",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0fa2aa59_17bcb6f5",
        "filename": "source/components/hardware/hwsleep.c",
        "patchSetId": 1
      },
      "lineNbr": 109,
      "author": {
        "id": 5232
      },
      "writtenOn": "2020-02-25T19:15:49Z",
      "side": 1,
      "message": "\u003c.\u003c Fuchsia",
      "parentUuid": "ca2f6919_187571e0",
      "range": {
        "startLine": 109,
        "startChar": 0,
        "endLine": 109,
        "endChar": 45
      },
      "revId": "9c43c1ac135f1e681a2c38b5c6cf72acfa34767a",
      "serverId": "ccdefb6c-23ea-33ff-848c-339fc6ca2269",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fa81ea7c_20d3dab0",
        "filename": "source/components/hardware/hwsleep.c",
        "patchSetId": 1
      },
      "lineNbr": 109,
      "author": {
        "id": 5155
      },
      "writtenOn": "2020-02-25T19:20:50Z",
      "side": 1,
      "message": "Since I wrote this a while ago, here\u0027s my attempt:\n\nThe upstream ACPICA code expects that AcpiHwLegacySleep() is invoked with interrupts disabled.  It requires this because the last steps of going to sleep is writing to a few registers, flushing the caches (so we don\u0027t lose data if the caches are dropped), and then writing to a register to enter the sleep.  If we were to take an interrupt after the cache flush but before entering sleep, we could have inconsistent memory after waking up.\n\nIn Fuchsia, ACPICA runs in usermode and we don\u0027t expose a mechanism for it to disable interrupts.  To ensure a consistent sleep, we split AcpiHwLegacySleep into two parts, the part that doesn\u0027t need interrupts disabled, and then the final part (AcpiHwLegacySleepFinal) that does.  We execute the first half in usermode, and then make a syscall into the kernel to execute the final steps.",
      "parentUuid": "ca2f6919_187571e0",
      "range": {
        "startLine": 109,
        "startChar": 0,
        "endLine": 109,
        "endChar": 45
      },
      "revId": "9c43c1ac135f1e681a2c38b5c6cf72acfa34767a",
      "serverId": "ccdefb6c-23ea-33ff-848c-339fc6ca2269",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "24feb4ca_3b5a569b",
        "filename": "source/components/hardware/hwsleep.c",
        "patchSetId": 1
      },
      "lineNbr": 116,
      "author": {
        "id": 5232
      },
      "writtenOn": "2020-02-25T19:12:00Z",
      "side": 1,
      "message": "You can omit this, I need to clean those lines out anyway.",
      "range": {
        "startLine": 116,
        "startChar": 0,
        "endLine": 116,
        "endChar": 70
      },
      "revId": "9c43c1ac135f1e681a2c38b5c6cf72acfa34767a",
      "serverId": "ccdefb6c-23ea-33ff-848c-339fc6ca2269",
      "unresolved": true
    }
  ]
}